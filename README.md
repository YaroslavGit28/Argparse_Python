# Техническое задание на проект "Демонстрационный стенд модуля argparse"

## 1. Общая информация

**Название проекта:** Демонстрационный стенд модуля argparse  
**Заказчик:** Учебная организация HERNY 
**Исполнитель:** Группа HERNY
**Цель проекта:** Создать консольное приложение для наглядной демонстрации возможностей модуля `argparse` стандартной библиотеки Python.

## 2. Описание задачи (что нужно сделать)

Необходимо разработать модульное консольное приложение, которое в интерактивном режиме демонстрирует практическое применение ключевых инструментов модуля `argparse`. Приложение должно показывать, как проектировать интерфейс командной строки, обрабатывать различные типы аргументов и создавать удобные CLI-утилиты.

## 3. Функциональные требования (что система должна уметь)

1. Система должна предоставлять подкоманды для различных операций.
2. Система должна демонстрировать работу позиционных аргументов.
3. Система должна показывать использование опциональных аргументов и флагов.
4. Система должна демонстрировать работу с типами данных (`int`, `float`, `Path`).
5. Система должна показывать применение `choices` для ограничения значений.
6. Система должна демонстрировать использование `nargs` для множественных значений.
7. Система должна содержать примеры взаимно исключающих групп аргументов.
8. Система должна поддерживать чтение аргументов из файла через `fromfile_prefix_chars`.
9. Система должна корректно обрабатывать неверный ввод пользователя и показывать понятные сообщения об ошибках.

## 4. Нефункциональные требования (ограничения)

1. Язык программирования: Python 3.10+
2. Используемые библиотеки: только стандартная библиотека Python (для `argparse_demo.py`)
3. Интерфейс: консольный (CLI)
4. Архитектура: модульная (разделение на функции построения парсера, обработчики подкоманд, вывод результатов)
5. Код должен соответствовать PEP 8
6. Проект должен запускаться на Windows, Linux и macOS

## 5. Требования к интерфейсу

1. При запуске программы с флагом `--help` отображается справка с описанием всех доступных подкоманд.
2. Программа содержит следующие подкоманды:
   - `greet` — приветствие пользователя с поддержкой повторений и режима "крика"
   - `calc` — выполнение арифметических операций над списком чисел
   - `file stats` — подсчёт статистики по текстовому файлу
3. Глобальные опции доступны для всех подкоманд:
   - `--verbose` / `-v` — подробный вывод
   - `--output` / `-o` — сохранение результата в файл
4. Пользователь выбирает подкоманду и передаёт необходимые аргументы через командную строку.
5. Для выхода из программы используется стандартное завершение процесса.

## 6. Входные и выходные данные

**Входные данные:**
- Подкоманда (greet, calc, file stats)
- Аргументы подкоманды (имя, числа, путь к файлу и т.д.)
- Глобальные флаги (`--verbose`, `--output`)
- Файл с аргументами (при использовании `@args.txt`)

**Выходные данные:**
- Результаты операций (приветствия, результаты вычислений, статистика файлов)
- Сообщения о ходе выполнения операций
- Ошибки валидации с понятными сообщениями
- Автоматически сгенерированная справка (`--help`)

## 7. Критерии приёмки (когда работа считается выполненной)

Работа считается выполненной, если:

1. Реализованы все функциональные требования из пункта 3.
2. Программа запускается командой `python argparse_demo.py --help` без ошибок.
3. Все подкоманды работают корректно и показывают заявленный функционал.
4. Подкоманды демонстрируют разные типы аргументов (позиционные, опциональные, с типами, choices, nargs).
5. Реализованы взаимно исключающие группы аргументов (например, `--int` / `--precise` в calc).
6. Поддерживается чтение аргументов из файла через `@args.txt`.
7. Код разделён на логические функции (построение парсера, обработчики, вывод).
8. Проект загружен в Git-репозиторий с полной структурой файлов.
9. В репозитории присутствует файл README.md с описанием проекта.
10. Создана подробная документация в папке `docs/`.

## 8. Дополнительные условия

1. **Срок выполнения:** 2 недели с момента получения задания.
2. **Формат сдачи:** ссылка на публичный Git-репозиторий (GitHub/GitLab).
3. **Требования к коду:**
   - Наличие документации в виде docstrings
   - Соответствие PEP 8
   - Логичное именование переменных и функций
4. **Критерии оценки:**
   - Полнота реализации функциональных требований
   - Качество и читаемость кода
   - Корректность работы всех подкоманд
   - Качество документации в README.md и docs/

---

# Документация проекта

## Структура проекта

```
argparse-demo/
├── argparse_demo.py    # Основное приложение с демонстрацией argparse
├── main.py             # Дополнительная программа: трекер задач с Rich
├── docs/               # Документация проекта
│   ├── argparse_module.md
│   ├── overview.md
│   ├── program_overview.md
│   ├── conclusions.md
│   ├── sources.md
│   └── task.md
└── README.md           # Документация проекта
```

## Описание модулей

### 1. `argparse_demo.py` - Основное приложение

Содержит полную демонстрацию возможностей модуля `argparse`:

- **`build_parser()`** - построение парсера аргументов с подкомандами
- **`handle_greet()`** - обработчик подкоманды `greet` (приветствие)
- **`handle_calc()`** - обработчик подкоманды `calc` (арифметические операции)
- **`handle_file_stats()`** - обработчик подкоманды `file stats` (статистика файла)
- **`write_output()`** - единая точка вывода результатов
- **`main()`** - главная функция запуска программы

**Демонстрируемые возможности:**
- Позиционные аргументы (`name`, `operation`, `path`)
- Опциональные аргументы (`--times`, `--shout`, `--verbose`)
- Типы данных (`int`, `float`, `Path`)
- Ограничения значений (`choices=["add", "sub", "mul", "div"]`)
- Множественные значения (`nargs="+"`)
- Взаимоисключающие группы (`--int` / `--precise`)
- Чтение из файла (`fromfile_prefix_chars="@")
- Глобальные опции для всех подкоманд

### 2. `main.py` - Дополнительная программа

Трекер задач с использованием библиотеки Rich для красивого консольного интерфейса:

- **`Task`** - dataclass для представления задачи
- **`TaskRepository`** - класс для работы с хранилищем задач (JSON)
- **`render_tasks_table()`** - отображение задач в виде таблицы
- **`add_task_flow()`** - добавление новой задачи
- **`change_status_flow()`** - изменение статуса задачи
- **`delete_task_flow()`** - удаление задачи
- **`simulate_progress_flow()`** - демонстрация прогресс-бара

**Примечание:** Эта программа демонстрирует использование библиотеки Rich и не связана напрямую с argparse, но показывает альтернативный подход к созданию консольных интерфейсов.

### 3. `docs/` - Документация

Содержит подробную документацию по проекту:

- **`task.md`** - техническое задание
- **`overview.md`** - обзор модуля argparse
- **`program_overview.md`** - обзор программы
- **`argparse_module.md`** - детальное описание модуля
- **`conclusions.md`** - выводы и заключения
- **`sources.md`** - использованные источники

## Как использовать

### Установка и запуск

1. Убедитесь, что у вас установлен Python 3.10 или выше
2. Скопируйте все файлы проекта в одну директорию
3. Запустите приложение:

```bash
python argparse_demo.py --help
```

### Работа с приложением

#### Основная справка:
```bash
python argparse_demo.py --help
```

#### Примеры использования подкоманд:

**1. Подкоманда `greet` (приветствие):**
```bash
# Простое приветствие
python argparse_demo.py greet Alex

# Приветствие несколько раз
python argparse_demo.py greet Alex --times 3

# Приветствие в режиме "крика"
python argparse_demo.py greet Alex --times 2 --shout

# С подробным выводом
python argparse_demo.py greet Alex --times 3 --verbose
```

**2. Подкоманда `calc` (калькулятор):**
```bash
# Сложение чисел
python argparse_demo.py calc add 1 2 3 4

# Вычитание
python argparse_demo.py calc sub 10 3 2

# Умножение
python argparse_demo.py calc mul 2 3 4

# Деление
python argparse_demo.py calc div 100 5 2

# С выводом как целое число
python argparse_demo.py calc add 1.5 2.5 --int

# С высокой точностью
python argparse_demo.py calc div 1 3 --precise
```

**3. Подкоманда `file stats` (статистика файла):**
```bash
# Подсчёт строк, слов и символов
python argparse_demo.py file stats example.txt

# С подробным выводом
python argparse_demo.py file stats example.txt --verbose

# Сохранение результата в файл
python argparse_demo.py file stats example.txt --output result.txt
```

**4. Использование файла аргументов:**

Создайте файл `args.txt`:
```text
greet
Alex
--times
3
--shout
```

Запустите:
```bash
python argparse_demo.py @args.txt
```

## Демонстрации

### 1. Позиционные аргументы
Подкоманда `greet` демонстрирует обязательный позиционный аргумент `name`, который должен быть указан первым после подкоманды.

### 2. Опциональные аргументы
Флаги `--times`, `--shout`, `--verbose` показывают, как работать с опциональными параметрами, которые могут иметь значения по умолчанию.

### 3. Типы данных
- `--times` использует `type=int` для автоматического преобразования строки в число
- `calc` использует `type=float` для работы с десятичными числами
- `file stats` использует `type=Path` для работы с путями к файлам

### 4. Ограничения значений (choices)
Подкоманда `calc` демонстрирует использование `choices=["add", "sub", "mul", "div"]` для ограничения допустимых операций.

### 5. Множественные значения (nargs)
В `calc` аргумент `numbers` использует `nargs="+"` для приёма одного или более чисел.

### 6. Взаимоисключающие группы
В `calc` флаги `--int` и `--precise` находятся во взаимно исключающей группе, что означает, что можно использовать только один из них.

### 7. Глобальные опции
Флаги `--verbose` и `--output` доступны для всех подкоманд, демонстрируя концепцию глобальных опций.

### 8. Чтение из файла
Использование `fromfile_prefix_chars="@"` позволяет передавать аргументы из файла, что полезно для автоматизации и повторяющихся команд.

## Ключевые концепции

### 1. Позиционные аргументы
- **Проблема:** необходимость обработки обязательных параметров в определённом порядке
- **Решение:** использование позиционных аргументов, которые argparse автоматически проверяет
- **Пример:** `greet.add_argument("name", help="имя человека")`

### 2. Опциональные аргументы
- **Проблема:** необходимость поддержки необязательных параметров с значениями по умолчанию
- **Решение:** использование опциональных аргументов с префиксом `--` или `-`
- **Пример:** `greet.add_argument("--times", type=int, default=1)`

### 3. Типы данных
- **Проблема:** необходимость преобразования строковых аргументов в нужные типы
- **Решение:** указание `type` при добавлении аргумента
- **Пример:** `calc.add_argument("numbers", type=float, nargs="+")`

### 4. Подкоманды (subparsers)
- **Проблема:** необходимость организации сложных CLI с множеством операций
- **Решение:** использование `add_subparsers()` для создания иерархии команд
- **Пример:** `subparsers = parser.add_subparsers(dest="command")`

### 5. Взаимоисключающие группы
- **Проблема:** необходимость запретить одновременное использование определённых флагов
- **Решение:** создание группы через `add_mutually_exclusive_group()`
- **Пример:** `fmt_group = calc.add_mutually_exclusive_group()`

### 6. Чтение из файла
- **Проблема:** необходимость повторного использования длинных команд
- **Решение:** использование `fromfile_prefix_chars` для чтения аргументов из файла
- **Пример:** `parser = argparse.ArgumentParser(fromfile_prefix_chars="@")`

## Примеры вывода

### Справка по программе:
```
usage: argparse-demo [-h] [-v] [-o PATH] COMMAND ...

Обучающий пример использования модуля argparse.
Программа демонстрирует несколько подкоманд и разные типы аргументов.

positional arguments:
  COMMAND               действие, которое нужно выполнить
                        (greet, calc, file)

optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         подробный вывод
  -o PATH, --output PATH
                        сохранить вывод в файл
```

### Демонстрация greet:
```
==================================================
Блок приветствия для: Alex
--------------------------------------------------
Привет, Alex!
Привет, Alex!
Привет, Alex!
==================================================
```

### Демонстрация calc:
```
==================================================
Блок калькулятора: add
--------------------------------------------------
Операция: сумма
Числа: [1.0, 2.0, 3.0, 4.0]
Результат: 10.0
==================================================
```

### Демонстрация file stats:
```
==================================================
Статистика по файлу
--------------------------------------------------
Файл: example.txt
Строк: 15
Слов: 120
Символов: 856
==================================================
```

## Заключение

Данный проект служит наглядным пособием для понимания практической пользы модуля `argparse`. Каждая подкоманда демонстрирует конкретные возможности модуля, показывая, как стандартные инструменты Python могут помочь в создании удобных и надёжных интерфейсов командной строки. Проект показывает, что `argparse` — это мощный инструмент для создания CLI-приложений, который избавляет разработчика от рутинной работы по разбору и валидации аргументов командной строки.
